var nago=(()=>{var m=(s,r)=>()=>(r||s((r={exports:{}}).exports,r),r.exports);var M=m((ai,_)=>{function U(s,r){this.x=s,this.y=r}_.exports=U});var q=m((pi,D)=>{var X=M();function Y(s){var{cGroup:r=32,cMask:h=63,bCoef:e=1,xpos:t=0,ypos:p=0}=s||{};this.cGroup=r,this.cMask=h,this.bCoef=e,this.pos=new X(t,p)}D.exports=Y});var F=m((ui,G)=>{var g=M(),Z=.17435839227423353,$=5.934119456780721,P=.017453292519943295,z=114.59155902616465;function L(s){var{cGroup:r=32,cMask:h=63,bCoef:e=1,bias:t=0,p0:p=null,p1:i=null}=s||{};this.normal=null,this.p1NormalDir=null,this.p0NormalDir=null,this.arcRadius=0,this.arcCenter=null,this.p0=p,this.p1=i,this.bias=t,this.bCoef=e,this.cMask=h,this.cGroup=r,this.curveF=1/0}L.prototype={setCurveDegrees:function(s){if(s*=P,s<0){s=-s;var r=this.p0;this.p0=this.p1,this.p1=r,this.bias=-this.bias}s>Z&&s<$&&(this.curveF=1/Math.tan(s/2))},getCurveDegrees:function(){return 0*this.curveF==0?z*Math.atan(1/this.curveF):0},calculateNormals:function(){if(0*this.curveF==0){var r=this.p1.pos,h=this.p0.pos,s=.5*(r.x-h.x),r=.5*(r.y-h.y),h=this.p0.pos,e=this.curveF;this.arcCenter=new g(h.x+s-r*e,h.y+r+s*e),r=this.p0.pos,h=this.arcCenter,s=r.x-h.x,r=r.y-h.y,this.arcRadius=Math.sqrt(s*s+r*r),this.p0NormalDir=new g(-r,s),this.p1NormalDir=new g(this.p1.pos.y-this.arcCenter.y,this.arcCenter.x-this.p1.pos.x),this.curveF<=0&&(r=s=this.p0NormalDir,s.x=-r.x,s.y=-r.y,r=s=this.p1NormalDir,s.x=-r.x,s.y=-r.y)}else r=this.p0.pos,h=this.p1.pos,s=r.x-h.x,r=h.y-r.y,h=Math.sqrt(r*r+s*s),this.normal=new g(r/h,s/h)}};G.exports=L});var I=m((hi,N)=>{var ii=M();function ei(s){var{cGroup:r=32,cMask:h=63,bCoef:e=1,dist:t=0,xnormal:p=0,ynormal:i=0}=s||{};this.cGroup=r,this.cMask=h,this.bCoef=e,this.dist=t,this.normal=new ii(p,i)}N.exports=ei});var A=m((xi,V)=>{var w=M();function S(s){var{p0x:r=0,p0y:h=0,p1x:e=0,p1y:t=0}=s||{};this.p1=new w(e,t),this.p0=new w(r,h)}S.prototype={advance:function(s,r){var h=this.p0,e=this.p1,t=r.x-s.x,p=r.y-s.y;return p*(h.x-s.x)-t*(h.y-s.y)>0==p*(e.x-s.x)-t*(e.y-s.y)>0?!1:(t=e.x-h.x,e=e.y-h.y,e*(s.x-h.x)-t*(s.y-h.y)>0!=e*(r.x-h.x)-t*(r.y-h.y)>0)}};V.exports=S});var b=m((yi,J)=>{var d=M();function ti(s){var{cGroup:r=63,cMask:h=63,damping:e=.99,invMass:t=1,bCoef:p=.5,radius:i=10,xgravity:a=0,ygravity:C=0,xspeed:f=0,yspeed:y=0,xpos:u=0,ypos:o=0}=s||{};this.cGroup=r,this.cMask=h,this.damping=e,this.invMass=t,this.bCoef=p,this.radius=i,this.gravity=new d(a,C),this.speed=new d(f,y),this.pos=new d(u,o)}J.exports=ti});var k=m((vi,R)=>{function ri(s){var{strength:r=1/0,maxLength:h=100,minLength:e=100,d1:t=0,d0:p=0}=s||{};this.strength=r,this.maxLength=h,this.minLength=e,this.d1=t,this.d0=p}R.exports=ri});var B=m((li,W)=>{var si=b();function T(s){si.apply(this,[s])}T.prototype={addVelocity:function(s,r){var h=this.speed;h.x+=s,h.y+=r},applyForce:function(s,r,h){var e=this.speed,t=this.invMass;e.x+=s*r*t,e.y+=s*h*t},isMoving:function(){var s=this.speed;return s.x*s.x+s.y*s.y>0}};W.exports=T});var K=m((Ci,H)=>{function E(){this.moveableCircularObjects=[],this.dotObjects=[],this.infiniteLinearObjects=[],this.finiteArcObjects=[],this.distanceConstraints=[],this.finiteLinearSensors=[]}E.prototype={advance:function(s,r){for(var h=0,e=this.moveableCircularObjects;h<e.length;h++){var t=e[h],p=t.pos,i=t.pos,a=t.speed;p.x=i.x+s*a.x,p.y=i.y+s*a.y,i=p=t.speed,a=t.gravity,t=t.damping,p.x=t*(i.x+a.x),p.y=t*(i.y+a.y)}for(var C=0,h=this.moveableCircularObjects.length;C<h;C++){for(e=this.moveableCircularObjects[C],t=C+1;t<h;t++)if(i=this.moveableCircularObjects[t],!(!(i.cMask&e.cGroup)||!(i.cGroup&e.cMask))){var u=e.pos,o=i.pos,y=u.x-o.x,u=u.y-o.y,p=i.radius+e.radius,n=y*y+u*u;if(n>0&&n<=p*p){var f=i,n=Math.sqrt(n),y=y/n,u=u/n,o=e.invMass/(e.invMass+i.invMass),p=p-n,n=p*o,a=e.pos,x=e.pos;a.x=x.x+y*n,a.y=x.y+u*n,x=a=i.pos,p-=n,a.x=x.x-y*p,a.y=x.y-u*p,p=e.speed,n=i.speed,p=y*(p.x-n.x)+u*(p.y-n.y),p<0&&(p*=e.bCoef*i.bCoef+1,o*=p,a=n=e.speed,n.x=a.x-y*o,n.y=a.y-u*o,i=n=i.speed,o=p-o,n.x=i.x+y*o,n.y=i.y+u*o,r?._CDD_&&r?._CDD_(C,e.playerId,t,f.playerId))}}if(e.invMass!=0){for(t=0,p=this.infiniteLinearObjects;t<p.length;t++)if(i=p[t],!(!(i.cMask&e.cGroup)||!(i.cGroup&e.cMask))){var a=i.normal,x=e.pos,a=i.dist-(a.x*x.x+a.y*x.y)+e.radius;if(a>0){var v=x=e.pos,c=i.normal;x.x=v.x+a*c.x,x.y=v.y+a*c.y,a=e.speed,x=i.normal,a=a.x*x.x+a.y*x.y,a<0&&(a*=e.bCoef*i.bCoef+1,v=x=e.speed,i=i.normal,x.x=v.x-a*i.x,x.y=v.y-a*i.y,r?._CDP_&&r?._CDP_(C,e.playerId,t))}}for(t=0,p=this.finiteArcObjects;t<p.length;t++)if(i=p[t],!(!(i.cMask&e.cGroup)||!(i.cGroup&e.cMask))){var l,n,o;if(0*i.curveF!=0){l=i.p0.pos;var u=i.p1.pos;n=u.x-l.x;var y=u.y-l.y,a=e.pos;if(o=a.x-u.x,u=a.y-u.y,a=e.pos,n*(a.x-l.x)+y*(a.y-l.y)<=0||o*n+u*y>=0)continue;n=i.normal,l=n.x,n=n.y,o=l*o+n*u}else{if(n=i.arcCenter,o=e.pos,l=o.x-n.x,n=o.y-n.y,o=i.p0NormalDir,u=i.p1NormalDir,(l*o.x+n*o.y>0&&l*u.x+n*u.y>0)==i.curveF<=0||(u=Math.sqrt(l*l+n*n),u==0))continue;o=u-i.arcRadius,l/=u,n/=u}if(u=i.bias,u==0)o<0&&(o=-o,l=-l,n=-n);else if(u<0&&(u=-u,o=-o,l=-l,n=-n,o<-u))continue;e.radius<=o||(o=e.radius-o,y=u=e.pos,u.x=y.x+l*o,u.y=y.y+n*o,o=e.speed,o=l*o.x+n*o.y,o<0&&(o*=e.bCoef*i.bCoef+1,u=i=e.speed,i.x=u.x-l*o,i.y=u.y-n*o,r?._CDS_&&r?._CDS_(C,e.playerId,t)))}for(t=0,p=this.dotObjects;t<p.length;t++)if(i=p[t],!(!(i.cMask&e.cGroup)||!(i.cGroup&e.cMask))&&(x=e.pos,v=i.pos,a=x.x-v.x,x=x.y-v.y,v=a*a+x*x,v>0&&v<=e.radius*e.radius)){var v=Math.sqrt(v),a=a/v,x=x/v,v=e.radius-v,O=c=e.pos;if(c.x=O.x+a*v,c.y=O.y+x*v,v=e.speed,v=a*v.x+x*v.y,!(v<0)){r?._CDV_&&r?._CDV_(C,e.playerId,t,!1);continue}v*=e.bCoef*i.bCoef+1,c=i=e.speed,i.x=c.x-a*v,i.y=c.y-x*v,r?._CDV_&&r?._CDV_(C,e.playerId,t,!0)}}}for(C=0;C<2;C++)for(h=0,e=this.distanceConstraints;h<e.length;h++){var u=e[h],y=this.moveableCircularObjects,n=y[u.d0];if(y=y[u.d1],!(!y||!n)){var o=n.pos,t=y.pos,p=o.x-t.x,o=o.y-t.y,i=Math.sqrt(p*p+o*o);if(!(i<=0)){p/=i,o/=i,t=n.invMass/(n.invMass+y.invMass),isNaN(t)&&(t=.5);var a,x;if(u.minLength>=u.maxLength)a=u.minLength,x=0;else if(i<=u.minLength)a=u.minLength,x=1;else if(i>=u.maxLength)a=u.maxLength,x=-1;else continue;if(i=a-i,0*u.strength==0)t=u.strength*i*.5,p*=t,o*=t,x=t=n.speed,n=n.invMass,t.x=x.x+p*n,t.y=x.y+o*n,t=n=y.speed,y=y.invMass,n.x=t.x-p*y,n.y=t.y-o*y,r?._MJ_&&r?._MJ_(h,!1,!0);else{a=i*t;var v=n.pos,c=n.pos;v.x=c.x+p*a*.5,v.y=c.y+o*a*.5,c=v=y.pos,i-=a,v.x=c.x-p*i*.5,v.y=c.y-o*i*.5,i=n.speed,a=y.speed,i=p*(i.x-a.x)+o*(i.y-a.y);var j=i*x<=0;j&&(t*=i,n=x=n.speed,x.x=n.x-p*t,x.y=n.y-o*t,y=n=y.speed,t=i-t,n.x=y.x+p*t,n.y=y.y+o*t),r?._MJ_&&r?._MJ_(h,!0,j)}}}}},addMoveableCircularObject:function(s){this.moveableCircularObjects.push(s)},removeMoveableCircularObject:function(s){var r=this.moveableCircularObjects.indexOf(s);r<0||this.moveableCircularObjects.splice(r,1)}};H.exports=E});var ni=m((ci,Q)=>{Q.exports={Point:M(),DotObject:q(),FiniteArcObject:F(),InfiniteLinearObject:I(),FiniteLinearSensor:A(),CircularObject:b(),DistanceConstraint:k(),MoveableCircularObject:B(),World:K()}});return ni();})();
